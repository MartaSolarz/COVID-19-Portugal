<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model Metrics Table</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: center;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
        .min-value {
            background-color: #ff9393;
        }
        .max-value {
            background-color: #96f896;
        }
    </style>
</head>
<body>

<table>
    <thead>
        <tr>
            <th>Metric</th>
            <th>Linear Regression</th>
            <th>LASSO</th>
            <th>Ridge</th>
            <th>ElasticNet</th>
            <th>Random Forest</th>
            <th>Decision Tree</th>
            <th>Gradient Boosting</th>
            <th>AdaBoost</th>
            <th>XGBoost</th>
            <th>CatBoost</th>
            <th>KNN</th>
        </tr>
    </thead>
    <tbody>
        <script>
            const data = {
                "new_cases": [0.0002737401234457671, 0.0002745759381087197, 0.00027385080767173783, 0.0002755602794206551, 0.015971546040594878, 0.009212412161927688, 0.007739462759177335, 0.014329590096894869, 0.0062362207, 0.975266078565526, 0.00329562861648629],
                "reproduction_rate": [9.764351694749863, 9.747573200055383, 9.764375972175666, 9.74790427727113, 0.002943044352940476, 0.0011371345171163844, 0.0004960601044075864, 0.005139188765052457, 0.0009358138, 0.3862957799434155, 2.9201590034944046e-10],
                "icu_patients": [-0.04165925298747498, -0.04134997040400112, -0.0416429542932332, -0.04120565151484342, 0.14744296858174843, 0.0006152439730556553, 0.025146350917969854, 0.14819430322928917, 0.011281003, 66.77446927779596, 7.21726409900314e-05],
                "hosp_patients": [0.032170814072010105, 0.03213996606535943, 0.03216933567993777, 0.03212686026019286, 0.6627312099127325, 0.8924534206773435, 0.8518627303174842, 0.6809321639909545, 0.83911264, 5.837569934178717, 0.012073519869013671],
                "new_tests": [-0.00014442491961456677, -0.0001444723554076441, -0.00014443866694798286, -0.00014459459743942915, 0.006207066555989285, 0.0022014134167532328, 0.0009515462467481036, 0.004660660502917097, 0.0009958404, 0.6903362834442469, 0.48866431886429423],
                "positive_rate": [18.79985315132768, 18.604702299639637, 18.773364225208134, 18.36946716618046, 0.06352053139455523, 0.07902656665605173, 0.08788682553379681, 0.054531767313433614, 0.12297703, 13.71385950188746, -2.1622259538389697e-12],
                "people_vaccinated": [-8.227700559602716e-06, -7.892833851770533e-06, -8.218753437890246e-06, -7.814811324168388e-06, 0.008199082996713732, 0.0027071228513511555, 0.006349867334161687, 0.0046040193769788735, 0.01086414, 0.23395329644135757, 0.730650929784616],
                "people_fully_vaccinated": [-8.884049596327531e-06, -9.183630078440572e-06, -8.891304405854334e-06, -9.246647957583794e-06, 0.0032619179450313353, 8.137896622092934e-08, 0.0015597457300360335, 0.0075583378532411115, 0.0, 0.0038395946108769957, 0.4371690680079743],
                "total_boosters": [-6.708688387472781e-06, -6.63247259297603e-06, -6.702646642649196e-06, -6.578998006653473e-06, 0.007824939624767, 1.7767740958235697e-05, 0.0015428967054376746, 0.004954533418891415, 0.0, 0.06411331736468297, 0.07247757646151917],
                "stringency_index": [-0.05309953004865815, -0.05386856420754698, -0.053149017670058946, -0.05431150779171441, 0.0025295405182374146, 0.006287436582180402, 0.0023551256335179673, 0.0022692382124773294, 0.0012730879, 1.0360663248273623, -2.2272728217309636e-09],
                "excess_mortality_cumulative_absolute": [0.022133906085340955, 0.02206120942502167, 0.022130555263814997, 0.02203145456488228, 0.012510145660695712, 1.627579324418587e-05, 0.005236715401387113, 0.005393061431451022, 0.0011257213, 2.151355511699785, 0.001471244803358629],
                "excess_mortality_cumulative": [-22.880929785160852, -22.819805810050134, -22.877442856442133, -22.788663674190726, 0.01912138880797182, 6.310500635999574e-05, 0.000324169293631565, 0.005380291027052529, 0.00042444348, 2.7401549407622046, 2.592225878395027e-10],
                "excess_mortality": [3.840811764613131, 3.842855154638733, 3.8408912357861578, 3.843543965148182, 0.047736617608022246, 0.006262019244691505, 0.008548504022244097, 0.062052844781366114, 0.004774095, 5.392720158478428, -2.4636182205384215e-09]
            };

            function getRoundedValue(val) {
                const rounded = Math.round(val * 1000) / 1000;
                return rounded === 0 ? "<0.001" : rounded.toFixed(3);
            }

            // Generate table rows
            const keys = Object.keys(data);
            const rowCount = keys.length;
            const colCount = data[keys[0]].length;

            // Initialize 2D array to store min/max class names
            const classMatrix = Array.from({ length: rowCount }, () => Array(colCount).fill(''));

            // Find min and max in each column based on absolute values
            for (let col = 0; col < colCount; col++) {
                let colValues = keys.map(key => Math.abs(data[key][col]));
                let minIndex = colValues.indexOf(Math.min(...colValues));
                let maxIndex = colValues.indexOf(Math.max(...colValues));
                classMatrix[minIndex][col] = 'min-value';
                classMatrix[maxIndex][col] = 'max-value';
            }

            // Render the table rows
            keys.forEach((key, rowIndex) => {
                document.write(`<tr><td style="text-align: left;">${key}</td>`);
                data[key].forEach((val, colIndex) => {
                    const roundedValue = getRoundedValue(val);
                    const className = classMatrix[rowIndex][colIndex];
                    document.write(`<td class="${className}">${roundedValue}</td>`);
                });
                document.write('</tr>');
            });
        </script>
    </tbody>
</table>

</body>
</html>
